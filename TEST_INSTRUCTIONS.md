# FSD环境切换功能测试说明

## 测试环境准备

1. **构建扩展**
   ```bash
   node scripts/build.js
   ```

2. **加载扩展到Chrome**
   - 打开Chrome浏览器
   - 访问 `chrome://extensions/`
   - 开启"开发者模式"
   - 点击"加载已解压的扩展程序"
   - 选择 `dist` 目录

## 测试步骤

### 测试1：FSD页面检测和渲染

1. **访问FSD工作台**
   - 在浏览器中访问：`https://fsd.sankuai.com/workbench`
   - 确保页面能正常加载

2. **打开环境切换助手**
   - 点击浏览器工具栏中的环境切换助手图标
   - 应该看到弹窗显示

3. **验证FSD环境检测**
   - 红色框区域应该显示：`fsd.sankuai.com/workbench`
   - 当前环境应该显示：`当前环境: PRODUCTION`

4. **验证FSD环境按钮**
   - 绿色框区域应该显示FSD环境配置，而不是旧的bots.sankuai.com配置
   - 应该看到三个FSD环境按钮：
     - FSD生产环境 (https://fsd.sankuai.com)
     - FSD预发环境 (https://fsd.waimai.st.sankuai.com)
     - FSD测试环境 (https://fsd.waimai.test.sankuai.com)

### 测试2：FSD环境切换功能

1. **测试生产环境切换**
   - 点击"FSD生产环境"按钮
   - 应该显示"已切换到生产环境"消息
   - 页面应该跳转到：`https://fsd.sankuai.com/workbench`

2. **测试预发环境切换**
   - 点击"FSD预发环境"按钮
   - 应该显示"已切换到预发环境"消息
   - 页面应该跳转到：`https://fsd.waimai.st.sankuai.com/workbench`

3. **测试测试环境切换**
   - 点击"FSD测试环境"按钮
   - 应该显示"已切换到测试环境"消息
   - 页面应该跳转到：`https://fsd.waimai.test.sankuai.com/workbench`

### 测试3：设置面板中的FSD配置

1. **打开设置面板**
   - 点击弹窗右上角的齿轮图标

2. **验证FSD环境配置**
   - 应该看到FSD环境配置说明
   - 三个环境配置项，显示为只读状态
   - 每个环境都有对应的切换按钮

## 预期结果

### 成功情况
- ✅ FSD页面自动检测
- ✅ 显示正确的FSD环境配置
- ✅ 环境切换功能正常
- ✅ 样式显示正确（紫色主题）
- ✅ 当前环境高亮显示

### 失败情况
- ❌ 仍然显示旧的bots.sankuai.com配置
- ❌ 环境切换失败
- ❌ 样式显示异常
- ❌ 页面检测失败

## 故障排除

### 如果功能不工作

1. **检查控制台错误**
   - 按F12打开开发者工具
   - 查看Console标签页的错误信息

2. **重新加载扩展**
   - 在扩展管理页面点击"重新加载"按钮

3. **检查文件完整性**
   - 确认 `dist` 目录包含所有必要文件
   - 确认 `popup.js` 和 `popup.css` 已更新

4. **清除浏览器缓存**
   - 清除Chrome扩展的缓存数据

## 测试完成标准

- [ ] FSD页面检测正常
- [ ] FSD环境按钮显示正确
- [ ] 环境切换功能正常
- [ ] 样式显示正确
- [ ] 设置面板配置正确
- [ ] 错误处理正常

## 注意事项

1. **网络要求**：确保能访问所有FSD环境域名
2. **权限要求**：扩展需要标签页访问权限
3. **浏览器版本**：建议使用Chrome 88+版本
4. **测试数据**：切换环境时注意数据同步问题
